<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Nikto v2.2.0 - The Manual</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book"><div class="titlepage"><div><div>
<center><h1 class="title"><a name="idm446250074992"></a>Nikto v2.2.0 - The Manual</h1></center></div></div><hr></div>
<center><img src="alienlogo_vectorized.png"></center>
<hr>

<div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#introduction">1. Introduction</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446250067264">Overview</a></span></dt><dt><span class="section"><a href="#idm446250065936">Description</a></span></dt><dt><span class="section"><a href="#idm446250054640">Advanced Error Detection Logic</a></span></dt><dt><span class="section"><a href="#idm446250048848">History</a></span></dt></dl></dd><dt><span class="chapter"><a href="#installation">2. Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446250045792">Requirements</a></span></dt><dt><span class="section"><a href="#idm446250031696">Install</a></span></dt></dl></dd><dt><span class="chapter"><a href="#usage">3. Usage</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446250027664">Basic Testing</a></span></dt><dt><span class="section"><a href="#idm446250012144">Multiple Port Testing</a></span></dt><dt><span class="section"><a href="#idm446250008832">Multiple Host Testing</a></span></dt><dt><span class="section"><a href="#idm446250001600">Using a Proxy</a></span></dt><dt><span class="section"><a href="#idm446249997424">Updating</a></span></dt><dt><span class="section"><a href="#idm446249992288">Integration with Nessus</a></span></dt><dt><span class="section"><a href="#idm446249989136">Interactive Features</a></span></dt></dl></dd><dt><span class="chapter"><a href="#options">4. Command Line Options</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249976528">All Options</a></span></dt><dt><span class="section"><a href="#idm446249784736">Mutation Techniques</a></span></dt><dt><span class="section"><a href="#idm446249771616">Display</a></span></dt><dt><span class="section"><a href="#idm446249761200">Scan Tuning</a></span></dt><dt><span class="section"><a href="#idm446249741152">Replay Saved Requests</a></span></dt><dt><span class="section"><a href="#idm446249738448">Plugin selection</a></span></dt></dl></dd><dt><span class="chapter"><a href="#configuration">5. Configuration Files</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249718256">Location</a></span></dt><dt><span class="section"><a href="#idm446249712960">Format</a></span></dt><dt><span class="section"><a href="#idm446249711600">Variables</a></span></dt></dl></dd><dt><span class="chapter"><a href="#reports">6. Output and Reports</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249643264">Export Formats</a></span></dt><dt><span class="section"><a href="#idm446249639120">HTML and XML Customisation</a></span></dt></dl></dd><dt><span class="chapter"><a href="#developing">7. OSS Development</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249630192">Open Source Contributions</a></span></dt><dt><span class="section"><a href="#idm446249628896">Development Source</a></span></dt></dl></dd><dt><span class="chapter"><a href="#expanding">8. Test and Code Writing</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249624864">Scan Database Syntax</a></span></dt><dt><span class="section"><a href="#idm446249621936">Scan Database Field Values</a></span></dt><dt><span class="section"><a href="#idm446249601648">User-Defined Tests</a></span></dt><dt><span class="section"><a href="#idm446249595168">Plugins</a></span></dt><dt><span class="section"><a href="#idm446249574512">Initialization Phase</a></span></dt><dt><span class="section"><a href="#idm446249533568">Start hook</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249528768">Reconnaisance Phase</a></span></dt><dt><span class="section"><a href="#idm446249522160">Scan Phase</a></span></dt><dt><span class="section"><a href="#idm446249516880">Prefetch hook</a></span></dt><dt><span class="section"><a href="#idm446249509824">Postfetch hook</a></span></dt><dt><span class="section"><a href="#idm446249502448">Reporting Phase</a></span></dt><dt><span class="section"><a href="#idm446249464560">Data Structures</a></span></dt><dt><span class="section"><a href="#idm446249429200">Standard Methods</a></span></dt><dt><span class="section"><a href="#idm446249353712">Global Variables</a></span></dt></dl></dd><dt><span class="section"><a href="#idm446238811296">Test Identifiers</a></span></dt><dt><span class="section"><a href="#idm446238795136">Code Copyrights</a></span></dt></dl></dd><dt><span class="chapter"><a href="#troubleshooting">9. Troubleshooting</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446238792512">SOCKS Proxies</a></span></dt><dt><span class="section"><a href="#idm446238791296">Debugging</a></span></dt><dt><span class="section"><a href="#idm446238789232">Assistance</a></span></dt></dl></dd><dt><span class="chapter"><a href="#licences">10. Licenses</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446238786624">Nikto</a></span></dt><dt><span class="section"><a href="#idm446238785344">LibWhisker</a></span></dt><dt><span class="section"><a href="#idm446238784048">Tests</a></span></dt></dl></dd><dt><span class="chapter"><a href="#credits">11. Credits</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446238781632">Nikto</a></span></dt><dt><span class="section"><a href="#idm446238780304">Thanks</a></span></dt></dl></dd></dl></div><div class="list-of-tables"><p><b>List of Tables</b></p><dl><dt>8.1. <a href="#idm446249620128">Scan Database Fields</a></dt><dt>8.2. <a href="#idm446249461760">Members of the <span class="structname">Mark</span>
              structure</a></dt><dt>8.3. <a href="#idm446249440496">Members of the <span class="structname">Vulnerability</span>
              structure</a></dt><dt>8.4. <a href="#idm446249391280">Members of the <span class="structname">flags</span>
            structure</a></dt><dt>8.5. <a href="#idm446238809808">TID Scheme</a></dt></dl></div><div class="list-of-examples"><p><b>List of Examples</b></p><dl><dt>3.1. <a href="#idm446250005760">Valid Hosts File</a></dt><dt>8.1. <a href="#idm446249535136">Example initialisation function</a></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="introduction"></a>Chapter 1. Introduction</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446250067264">Overview</a></span></dt><dt><span class="section"><a href="#idm446250065936">Description</a></span></dt><dt><span class="section"><a href="#idm446250054640">Advanced Error Detection Logic</a></span></dt><dt><span class="section"><a href="#idm446250048848">History</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250067264"></a>Overview</h2></div></div></div><p>Nikto is a web server assessment tool. It is designed to find
      various default and insecure files, configurations and programs on any
      type of web server.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250065936"></a>Description</h2></div></div></div><p>Examine a web server to find potential problems and security vulnerabilities,
including:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Server and software misconfigurations</p></li><li class="listitem"><p>Default files and programs</p></li><li class="listitem"><p>Insecure files and programs</p></li><li class="listitem"><p>Outdated servers and programs</p></li></ul></div><p>Nikto is built on LibWhisker2 (by RFP) and can run on any platform
which has a Perl environment. It supports SSL, proxies, host
authentication, attack encoding and more. It can be updated automatically
from the command-line, and supports the optional submission of updated
version data back to the maintainers.</p><p>The name "Nikto" is taken from the movie "The Day the Earth Stood
      Still", and of course subsequent abuse by Bruce Campbell in "Army of
      Darkness". More information on the pop-culture popularity of Nikto can
      be found at <a class="ulink" href="http://www.blather.net/blather/2005/10/klaatu_barada_nikto_the_day_th.html" target="_top">http://www.blather.net/blather/2005/10/klaatu_barada_nikto_the_day_th.html</a></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250054640"></a>Advanced Error Detection Logic</h2></div></div></div><p>Most web security tools, (including Nikto 1.32 and below), rely
      heavily on the HTTP response to determine if a page or script exists on
      the target. Because many servers do not properly adhere to RFC standards
      and return a 200 "OK" response for requests which are not found or
      forbidden, this can lead to many false-positives. In addition, error
      responses for various file extensions can differ--the "not found"
      response for a .html file is often different than a .cgi.</p><p>Some testing tools, such as Nessus, also look at the content of
      the response to help eliminate these false positives. While often
      effective, this method relies on pre-defined strings to help eliminate
      false positives.</p><p>As of version 2.0 Nikto no longer assumes the error pages for
      different file types will be the same. A list of unique file extensions
      is generated at run-time (from the test database), and each of those
      extensions is tested against the target. For every file type, the "best
      method" of determining errors is found: standard RFC response, content
      match or MD4 hash (in decreasing order of preference). This allows Nikto
      to use the fastest and most accurate method for each individual file
      type, and therefore help eliminate the false positives seen for some
      servers in version 1.32 and below.</p><p>For example, if a server responds with a 404 "not found" error for
      a non-existent .txt file, Nikto will match the HTTP response of "404" on
      tests. If the server responds with a 200 "OK" response, it will try to
      match on the content, and assuming it finds a match (for example, the
      words "could not be found"), it will use this method for determining
      missing .txt files. If the other methods fail, Nikto will attempt to
      remove date and time strings (which can constantly change) from the
      returned page's content, generate an MD5 hash of the content, and then
      match that hash value against future .txt tests. The latter is by far
      the slowest type of match, but in many cases will provide valid results
      for a particular file type.</p><p>This feature is performed by making several requests for
      non-existent pages of various filetypes. This may add up to a thousand
      requests to the remote server during the lifetime of the scan. This may
      not be desireable over slow connection and can be disabled with the
      <em class="parameter"><code>-no404</code></em> option.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250048848"></a>History</h2></div></div></div><p>The Nikto 1.00 Beta was released on December 27, 2001, (followed
      almost immediately by the 1.01 release). Over the course of two years
      Nikto's code evolved into the most popular freely available web
      vulnerability scanner. The 2.0 release, in November, 2007 represents
      several years of improvements.</p><p>In 2008, David Lodge officially joined the development team and
      assumed leadership of Nikto while Chris Sullo pursued another
      committment. In 2009, Sullo rejoined the project.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="installation"></a>Chapter 2. Installation</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446250045792">Requirements</a></span></dt><dt><span class="section"><a href="#idm446250031696">Install</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250045792"></a>Requirements</h2></div></div></div><p>Any system which supports a basic Perl installation should allow
      Nikto to run. It has been extensively tested on:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Windows (using ActiveState Perl and Strawberry Perl). Some
          POSIX features, such as interactive commands may not work under
          Windows.</p></li><li class="listitem"><p>Mac OSX</p></li><li class="listitem"><p>Various Linux and Unix installations (including RedHat,
          Solaris, Debian, Ubuntu, BackTrack, etc.)</p></li></ul></div><p>The only required Perl module that does not come standard is
      LibWhisker. Nikto comes with and is configured to use a local LW.pm file
      (in the plugins directory). As of Nikto version 2.1.5, the included
      LibWhisker differs (slightly) from the standard LibWhisker 2.5
      distribution.</p><p>For SSL support the Net::SSLeay Perl module must be installed.
      Windows support for SSL is dependent on the installation package, but is
      rumored to exist for ActiveState's Perl.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Perl: <a class="ulink" href="http://www.cpan.org/" target="_top">http://www.cpan.org/</a></p></li><li class="listitem"><p>LibWhisker: <a class="ulink" href="http://www.wiretrip.net/" target="_top">http://www.wiretrip.net/</a></p></li><li class="listitem"><p>ActiveState Perl: <a class="ulink" href="http://www.activestate.com/" target="_top">http://www.activestate.com/</a></p></li><li class="listitem"><p>OpenSSL: <a class="ulink" href="http://www.openssl.org/" target="_top">http://www.openssl.org/</a></p></li></ul></div><p>Perl modules</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>JSON::PP - Saving requests and responses in a parseable format (optional). Required for -Savedir usage. May require additional modules.</p></li><li class="listitem"><p>MIME::Base64 - Speed up base64 operations (optional).</p></li><li class="listitem"><p>MD5 - Speed up MD5 operations (optional).</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250031696"></a>Install</h2></div></div></div><p>These instructions do not include information on installing Perl,
      Perl Modules, OpenSSL, LibWhisker or any of the utilities that may be
      needed during installation (such as gzip, tar, etc.). Please see the
      distributor's documentation for information on how to install and
      configure those software packages.</p><p>Unpack the download file:</p><pre class="screen">tar -xvfz nikto-current.tar.gz</pre><p>Assuming a standard OS/Perl installation, Nikto should now be
      usable. See Chapter 4 (Options) or Chapter 8 (Troubleshooting) for
      further configuration information.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="usage"></a>Chapter 3. Usage</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446250027664">Basic Testing</a></span></dt><dt><span class="section"><a href="#idm446250012144">Multiple Port Testing</a></span></dt><dt><span class="section"><a href="#idm446250008832">Multiple Host Testing</a></span></dt><dt><span class="section"><a href="#idm446250001600">Using a Proxy</a></span></dt><dt><span class="section"><a href="#idm446249997424">Updating</a></span></dt><dt><span class="section"><a href="#idm446249992288">Integration with Nessus</a></span></dt><dt><span class="section"><a href="#idm446249989136">Interactive Features</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250027664"></a>Basic Testing</h2></div></div></div><p>The most basic Nikto scan requires simply a host to target, since
      port 80 is assumed if none is specified. The host can either be an IP or
      a hostname of a machine, and is specified using the
      <em class="parameter"><code>-h</code></em> (<em class="parameter"><code>-host</code></em>) option. This
      will scan the IP 192.168.0.1 on TCP port 80:</p><pre class="screen">perl nikto.pl -h 192.168.0.1</pre><p>To check on a different port, specify the port number with the
      <em class="parameter"><code>-p</code></em> (<em class="parameter"><code>-port</code></em>) option. This
      will scan the IP 192.168.0.1 on TCP port 443:</p><pre class="screen">perl nikto.pl -h 192.168.0.1 -p 443</pre><p>Hosts, ports and protocols may also be specified by using a full
      URL syntax, and it will be scanned:</p><pre class="screen">perl nikto.pl -h https://192.168.0.1:443/</pre><p>There is no need to specify that port 443 may be SSL, as Nikto
      will first test regular HTTP and if that fails, HTTPS. If you are sure
      it is an SSL server, specifying <em class="parameter"><code>-s</code></em>
      (<em class="parameter"><code>-ssl</code></em>) will speed up the test.</p><pre class="screen">perl nikto.pl -h 192.168.0.1 -p 443 -ssl</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The <em class="parameter"><code>-mutate</code></em> and
        <em class="parameter"><code>-mutate-options</code></em> parameters have been deprecated
        in nikto 2.1.2. Plugin selections, using the
        <em class="parameter"><code>-Plugin</code></em> parameter, should be used instead.
        Nikto will automagically turn a mutate option into the appropriate
        selection string.</p></div><p>More complex tests can be performed using the
      <em class="parameter"><code>-mutate</code></em> parameter, as detailed later. This can
      produce extra tests, some of which may be provided with extra parameters
      through the <em class="parameter"><code>-mutate-options</code></em> parameter. For
      example, using <em class="parameter"><code>-mutate</code></em> 3, with or without a file
      attempts to brute force usernames if the web server allows
      ~<em class="replaceable"><code>user</code></em> URIs:</p><pre class="screen">perl nikto.pl -h 192.168.0.1 -mutate 3 -mutate-options user-list.txt</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250012144"></a>Multiple Port Testing</h2></div></div></div><p>Nikto can scan multiple ports in the same scanning session. To
      test more than one port on the same host, specify the list of ports in
      the <em class="parameter"><code>-p</code></em> (<em class="parameter"><code>-port</code></em>) option.
      Ports can be specified as a range (i.e., 80-90), or as a comma-delimited
      list, (i.e., 80,88,90). This will scan the host on ports 80, 88 and
      443.</p><pre class="screen">perl nikto.pl -h 192.168.0.1 -p 80,88,443</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250008832"></a>Multiple Host Testing</h2></div></div></div><p>Nikto support scanning multiple hosts in the same session via a
      text file of host names or IPs. Instead of giving a host name or IP for
      the <em class="parameter"><code>-h</code></em> (<em class="parameter"><code>-host</code></em>) option, a
      file name can be given. A file of hosts must be formatted as one host
      per line, with the port number(s) at the end of each line. Ports can be
      separated from the host and other ports via a colon or a comma. If no
      port is specified, port 80 is assumed.</p><p>This is an example of a valid hosts file:</p><div class="example"><a name="idm446250005760"></a><p class="title"><b>Example 3.1. Valid Hosts File</b></p><div class="example-contents"><pre class="programlisting">192.168.0.1:80
http://192.168.0.1:8080/
192.168.0.3</pre></div></div><br class="example-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>For win32 users: due to peculiaries in the way that cmd.exe
        works with pipes, the above example may not work for you. In this case
        a temporary file will have to be used to store the output from
        nmap</p></div><p>A host file may also be an nmap output in "greppable" format (i.e.
      from the output from -oG).</p><p>A file may be passed to Nikto through stdout/stdin using a "-" as
      the filename. For example:</p><pre class="screen">nmap -p80 192.168.0.0/24 -oG - | nikto.pl -h -</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446250001600"></a>Using a Proxy</h2></div></div></div><p>If the machine running Nikto only has access to the target host
      (or update server) via an HTTP proxy, the test can still be performed.
      There are two ways to use a proxy with Nikto, via the nikto.conf file or
      directly on the command line.</p><p>To use the nikto.conf file, set the <code class="varname">PROXY*</code>
      variables (as described in section 4), and then execute Nikto with the
      -useproxy option. All connections will be relayed through the HTTP proxy
      specified in the configuration file.</p><pre class="screen">perl nikto.pl -h localhost -p 80 -useproxy</pre><p>To set the proxy on the command line, use the -useproxy option
      with the proxy set as the argument, for example:</p><pre class="screen">./nikto.pl -h localhost -useproxy http://localhost:8080/</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249997424"></a>Updating</h2></div></div></div><p>Nikto can be automatically updated, assuming you have Internet
      connectivity from the host Nikto is installed on. To update to the
      latest plugins and databases, simply run Nikto with the -update
      command.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The -update option cannot be abbreviated.</p></div><pre class="screen">perl nikto.pl -update</pre><p>If updates are required, you will see a list of the files
      downloaded:</p><pre class="screen">
 perl nikto.pl -update
 + Retrieving 'nikto_core.plugin'
 + Retrieving 'CHANGES.txt'
      </pre><p>Updates may also be manually downloaded from the appropriate
      version's directory at <a class="ulink" href="http://cirt.net/nikto/UPDATES/" target="_top">http://cirt.net/nikto/UPDATES/</a>.
      Plugin and database files from the server should replace those in the
      'plugins' or 'databases' directories.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249992288"></a>Integration with Nessus</h2></div></div></div><p>Nessus (<a class="ulink" href="http://www.nessus.org/" target="_top">http://www.nessus.org/nessus/</a>) can
      be configured to automatically launch Nikto when it finds a web server.
      Ensure Nikto works properly, that nikto.pl is in the PATH, and that
      nikto.nasl is present in the Nessus install. Run 'nessusd -R' and then
      restart nessusd.</p><p>See <a class="ulink" href="http://blog.tenablesecurity.com/2008/09/using-nessus-to.html" target="_top">http://blog.tenablesecurity.com/2008/09/using-nessus-to.html</a>
      for detailed instructions.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249989136"></a>Interactive Features</h2></div></div></div><p>Nikto contains several options which can be changed during an
      active scan, provided it is running on a system which provides POSIX
      support, which includes *nix and some other operating systems. On
      systems without POSIX support, these features will be silently
      disabled.</p><p>During an active scan, pressing any of the keys below will turn on
      or off the listed feature or perform the listed action. Note that these
      are case sensitive.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>SPACE - Report current scan status</p></li><li class="listitem"><p>v - Turn verbose mode on/off</p></li><li class="listitem"><p>d - Turn debug mode on/off</p></li><li class="listitem"><p>e - Turn error reporting on/off</p></li><li class="listitem"><p>p - Turn progress reporting on/off</p></li><li class="listitem"><p>r - Turn redirect display on/off</p></li><li class="listitem"><p>c - Turn cookie display on/off</p></li><li class="listitem"><p>o - Turn OK display on/off</p></li><li class="listitem"><p>a - Turn auth display on/off</p></li><li class="listitem"><p>q - Quit</p></li><li class="listitem"><p>N - Next host</p></li><li class="listitem"><p>P - Pause</p></li></ul></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="options"></a>Chapter 4. Command Line Options</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446249976528">All Options</a></span></dt><dt><span class="section"><a href="#idm446249784736">Mutation Techniques</a></span></dt><dt><span class="section"><a href="#idm446249771616">Display</a></span></dt><dt><span class="section"><a href="#idm446249761200">Scan Tuning</a></span></dt><dt><span class="section"><a href="#idm446249741152">Replay Saved Requests</a></span></dt><dt><span class="section"><a href="#idm446249738448">Plugin selection</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249976528"></a>All Options</h2></div></div></div><p>Below are all of the Nikto command line options and explanations. A
brief version of this text is available by running Nikto with the -h
(-help) option.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-ask</code></span></dt><dd><p>Whether to ask about submitting updates: yes (ask about each--
the default), no (don't ask, just send), auto (don't ask, just send).
       </p></dd><dt><span class="term"><code class="option">-Cgidirs</code></span></dt><dd><p>Scan these CGI directories. Special words "none" or "all" may
be used to scan all CGI directories or none, (respectively). A
literal value for a CGI directory such as "/cgi-test/" may be
specified (must include trailing slash). If this is option is not
specified, all CGI directories listed in nikto.conf will be
tested.</p></dd><dt><span class="term"><code class="option">-config</code></span></dt><dd><p>Specify an alternative config file to use instead of the
nikto.conf file located in the install directory.</p></dd><dt><span class="term"><code class="option">-dbcheck</code></span></dt><dd><p>Check the scan databases for syntax errors.</p></dd><dt><span class="term"><code class="option">-Display</code></span></dt><dd><p>Control the output that Nikto shows. See Chapter 5 for
detailed information on these options. Use the reference number or
letter to specify the type. Multiple may be used:</p><p>1 - Show redirects</p><p>2 - Show cookies received</p><p>3 - Show all 200/OK responses</p><p>4 - Show URLs which require authentication</p><p>D - Debug Output</p><p>E - Display all HTTP errors</p><p>P - Print progress to STDOUT</p><p>V - Verbose Output</p></dd><dt><span class="term"><code class="option">-evasion</code></span></dt><dd><p>Specify the LibWhisker encoding/evasion technique to use (see the
LibWhisker docs for detailed information on these). Note that these are not
likely to actually bypass a modern IDS system, but may be useful for other
purposes. Use the reference number to specify the type, multiple may be used:</p><p>1 - Random URI encoding (non-UTF8)</p><p>2 - Directory self-reference (/./)</p><p>3 - Premature URL ending</p><p>4 - Prepend long random string</p><p>5 - Fake parameter</p><p>6 - TAB as request spacer</p><p>7 - Change the case of the URL</p><p>8 - Use Windows directory separator (\)</p><p>A - Use a carriage return (0x0d) as a request spacer</p><p>B - Use binary value 0x0b as a request spacer</p></dd><dt><span class="term"><code class="option">-Format</code></span></dt><dd><p>Save the output file specified with -o (-output) option in
this format. If not specified, the default will be taken from the file
extension specified in the -output option. Valid formats are:</p><p>csv - a comma-seperated list</p><p>htm - an HTML report</p><p>json - an JSON report</p><p>nbe - a Nessus NBE format report</p><p>sql - generic SQL</p><p>txt - a text report</p><p>xml - an XML report</p></dd><dt><span class="term"><code class="option">-host</code></span></dt><dd><p>Host(s) to target. Can be an IP address, hostname or text file
of hosts. A single dash (-) maybe used for stdin. Can also parse nmap -oG
style output</p></dd><dt><span class="term"><code class="option">-Headers</code></span></dt><dd><p>Set headers on all requests, in format of name:value pairs. CSV delimited if multple should be set.</p></dd><dt><span class="term"><code class="option">-Help</code></span></dt><dd><p>Display extended help information.</p></dd><dt><span class="term"><code class="option">-id</code></span></dt><dd><p>ID and password to use for host Basic host authentication.  Format is "id:password".</p></dd><dt><span class="term"><code class="option">-404code</code></span></dt><dd><p>Ignore these HTTP codes as negative responses (always). Format is "302,301".</p></dd><dt><span class="term"><code class="option">-404string</code></span></dt><dd><p>Ignore this string in response body content as negative response (always). Can be a regular expression..</p></dd><dt><span class="term"><code class="option">-list-plugins</code></span></dt><dd><p>Will list all plugins that Nikto can run against targets and
	    then will exit without performing a scan. These can be tuned for a
	    session using the <em class="parameter"><code>-Plugins</code></em> option.</p><p>The output format is:</p><p>Plugin <code class="varname">name</code></p><p><code class="varname">full name</code> - <code class="varname">description</code>
	    </p><p>Written by <code class="varname">author</code>, Copyright (C)
	    <code class="varname">copyright</code></p></dd><dt><span class="term"><code class="option">-maxtime</code></span></dt><dd><p>Maximum execution time per host, in seconds. Accepts minutes and hours
            such that all of these are one hour: 3600s, 60m, 1h</p></dd><dt><span class="term"><code class="option">-mutate</code></span></dt><dd><p>Specify mutation technique. A mutation will cause Nikto to
combine tests or attempt to guess values. These techniques may cause
a tremendous amount of tests to be launched against the target. Use
the reference number to specify the type, multiple may be
used:</p><p>1 - Test all files with all root directories</p><p>2 - Guess for password file names</p><p>3 - Enumerate user names via Apache (/~user type
requests)</p><p>4 - Enumerate user names via cgiwrap (/cgi-bin/cgiwrap/~user
type requests)</p><p>5 - Attempt to brute force sub-domain names, assume that
        the host name is the parent domain</p><p>6 - Attempt to guess directory names from the supplied
        dictionary file</p></dd><dt><span class="term"><code class="option">-mutate-options</code></span></dt><dd><p>Provide extra information for mutates, e.g. a dictionary
        file</p></dd><dt><span class="term"><code class="option">-nolookup</code></span></dt><dd><p>Do not perform name lookups on IP addresses.</p></dd><dt><span class="term"><code class="option">-nocache</code></span></dt><dd><p>Disable response cache</p></dd><dt><span class="term"><code class="option">-nointeractive</code></span></dt><dd><p>Disable interactive features</p></dd><dt><span class="term"><code class="option">-nossl</code></span></dt><dd><p>Do not use SSL to connect to the server.</p></dd><dt><span class="term"><code class="option">-no404</code></span></dt><dd><p>Disable 404 (file not found) checking. This will reduce
        the total number of requests made to the webserver and may be
        preferable when checking a server over a slow link, or an embedded
        device. This will generally lead to more false positives being
        discovered.</p></dd><dt><span class="term"><code class="option">-Option</code></span></dt><dd><p>Specify options to override settings in nikto.conf. Can be
        specified multiple times for multiple values.</p></dd><dt><span class="term"><code class="option">-output</code></span></dt><dd><p>Write output to the file specified. The format used will be
		taken from the file extension. This can be over-riden by using the
		-Format option (e.g. to write text files with a different extenstion.
		Existing files will have new information appended.</p><p>Multiple files may specified, in differing formats, by using a comma
    to separate the file names. For example "-o one.htm,two.sql"</p><p>A single dot (.) may be specified for the output file name, in which case
		the file name will be automatically generated based on the target being
		tested. Note that the -Format option is required when this is used. The
		scheme is: nikto_HOSTNAME_PORT_TIMESTAMP.FORMAT</p><p>For '-Format sql' a sample MySQL table create might look like:
		create table nikto_table (testid varchar(6) not null, ip varchar(15), hostname text, port int(5), usessl tinyint(1), osvdb int, httpmethod text, uri text, message text, request blob, response blob);</p></dd><dt><span class="term"><code class="option">-Plugins</code></span></dt><dd><p>Select which plugins will be run on the specified targets. A
		semi-colon separated list should be provided which lists the names of the
		plugins. The names can be found by using -list-plugins.</p><p>There are two special entries: @@ALL, which specifies all plugins
		shall be run and @@NONE, which specifies no plugins shall be run. The
		default is @@DEFAULT</p></dd><dt><span class="term"><code class="option">-port</code></span></dt><dd><p>TCP port(s) to target. To test more than one port on the same
host, specify the list of ports in the -p (-port) option. Ports can
be specified as a range (i.e., 80-90), or as a comma-delimited list,
(i.e., 80,88,90). If not specified, port 80 is used.</p></dd><dt><span class="term"><code class="option">-Pause</code></span></dt><dd><p>Seconds (integer or floating point) to delay between each test.</p></dd><dt><span class="term"><code class="option">-root</code></span></dt><dd><p>Prepend the value specified to the beginning of every request.
This is useful to test applications or web servers which have all of
their files under a certain directory.</p></dd><dt><span class="term"><code class="option">-ssl</code></span></dt><dd><p>Only test SSL on the ports specified. Using this option will
dramatically speed up requests to HTTPS ports, since otherwise the
HTTP request will have to timeout first.</p></dd><dt><span class="term"><code class="option">-Save</code></span></dt><dd><p>Save request/response of findings to this directory. Files are
plain text and will contain the raw request/response as well as JSON strings
for each. Use a "." to auto-generate a directory name for each target. These
saved items can be replayed by using the included replay.pl script, which can
route items through a proxy.</p></dd><dt><span class="term"><code class="option">-timeout</code></span></dt><dd><p>Seconds to wait before timing out a request. Default timeout
is 10 seconds.</p></dd><dt><span class="term"><code class="option">-Tuning</code></span></dt><dd><p>Tuning options will control the tests that Nikto will use
against a target. By default, all tests except Legacy are performed. If any options are
specified, those tests will be excluded (Legacy checks are implicitly enabled).
Use the reference number or letter to specify the type; multiple may be used:</p><p>0 - File Upload</p><p>1 - Interesting File / Seen in logs</p><p>2 - Misconfiguration / Default File</p><p>3 - Information Disclosure</p><p>4 - Injection (XSS/Script/HTML)</p><p>5 - Remote File Retrieval - Inside Web Root</p><p>6 - Denial of Service</p><p>7 - Remote File Retrieval - Server Wide</p><p>8 - Command Execution / Remote Shell</p><p>9 - SQL Injection</p><p>a - Authentication Bypass</p><p>b - Software Identification</p><p>e - Administration Console</p><p>c - Remote Source Inclusion</p><p>A - All tests (adds Legacy checks)</p></dd><dt><span class="term"><code class="option">-Userdbs</code></span></dt><dd><p>Load user defined databases instead of standard databases. User defined
        databases follow the same syntax as the standard files, but are prefixed with
        a 'u', e.g., 'udb_tests'</p><p>all - Disable all standard databases and load only user databases</p><p>tests - Disable db_tests and load udb_tests. All other databases are
        loaded normally.</p></dd><dt><span class="term"><code class="option">-until</code></span></dt><dd><p>Run until the specified time or duration, then pause.</p><p>Durations in hours, minutes or seconds, like: 1h, 60m, 3600s</p><p>Times like "mm dd hh:mm:ss" (mm, dd, ss optional): 12 1 22:30:00</p></dd><dt><span class="term"><code class="option">-update</code></span></dt><dd><p>Update the plugins and databases directly from cirt.net.</p></dd><dt><span class="term"><code class="option">-useproxy</code></span></dt><dd><p>Use the HTTP proxy defined in the configuration file. The proxy
        may also be directly set as an argument.</p></dd><dt><span class="term"><code class="option">-Version</code></span></dt><dd><p>Display the Nikto software, plugin and database
versions.</p></dd><dt><span class="term"><code class="option">-vhost</code></span></dt><dd><p>Specify the Host header to be sent to the target.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249784736"></a>Mutation Techniques</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The <em class="parameter"><code>-mutate</code></em> and
        <em class="parameter"><code>-mutate-options</code></em> parameters have been deprecated
        in nikto 2.1.2. Plugin selections, using the
        <em class="parameter"><code>-Plugin</code></em> parameter, should be used instead.
        Nikto will automagically turn a mutate option into the appropriate
        selection string.</p></div><p>A mutation will cause Nikto to combine tests or attempt to guess
      values. These techniques may cause a tremendous amount of tests to be
      launched against the target. Use the reference number to specify the
      type, multiple may be combined.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Test all files with all root directories. This takes each test
          and splits it into a list of files and directories. A scan list is
          then created by combining each file with each directory.</p></li><li class="listitem"><p>Guess for password file names. Takes a list of common password
          file names (such as "passwd", "pass", "password") and file
          extensions ("txt", "pwd", "bak", etc.) and builds a list of files to
          check for.</p></li><li class="listitem"><p>Enumerate user names via Apache (/~user type requests).
          Exploit a misconfiguration with Apache UserDir setups which allows
          valid user names to be discovered. This will attempt to brute-force
          guess user names. A file of known users can also be supplied by
          supplying the file name in the
          <em class="parameter"><code>-mutate-options</code></em> parameter.</p></li><li class="listitem"><p>Enumerate user names via cgiwrap (/cgi-bin/cgiwrap/~user type
          requests). Exploit a flaw in cgiwrap which allows valid user names
          to be discovered. This will attempt to brute-force guess user names.
          A file of known users can also be supplied by supplying the file
          name in the <em class="parameter"><code>-mutate-options</code></em> parameter.</p></li><li class="listitem"><p>Attempt to brute force sub-domain names. This will attempt to
          brute force know domain names, it will assume the given host
          (without a www) is the parent domain.</p></li><li class="listitem"><p>Attempt to brute directory names. This is the only mutate
          option that requires a file to be passed in the
          <em class="parameter"><code>-mutate-options</code></em> parameter. It will use the
          given file to attempt to guess directory names. Lists of common
          directories may be found in the OWASP DirBuster project.</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249771616"></a>Display</h2></div></div></div><p>By default only some basic information about the target and
      vulnerabilities is shown. Using the <em class="parameter"><code>-Display</code></em>
      parameter can produce more information for debugging issues.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>1 - Show redirects. This will display all requests which
          elicit a "redirect" response from the server.</p></li><li class="listitem"><p>2 - Show cookies received. This will display all cookies that
          were sent by the remote host.</p></li><li class="listitem"><p>3 - Show all 200/OK responses. This will show all responses
          which elicit an "okay" (200) response from the server. This could be
          useful for debugging.</p></li><li class="listitem"><p>4 - Show URLs which require authentication. This will show all
          responses which elicit an "authorization required" header.</p></li><li class="listitem"><p>D - Debug Output. Show debug output, which shows the verbose
          output and extra information such as variable content.</p></li><li class="listitem"><p>E - Display all HTTP errors. Show details for any HTTP error
          encountered.</p></li><li class="listitem"><p>P - Print progress to STDOUT. Show status report to STDOUT
          during testing (interval set in nikto.conf).</p></li><li class="listitem"><p>V - Verbose Output. Show verbose output, which typically shows
          where Nikto is during program execution.</p></li><li class="listitem"><p>E - Error Output. Display all HTTP and communications errors,
          which show a lot of output on some servers.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249761200"></a>Scan Tuning</h2></div></div></div><p>Scan tuning can be used to decrease the number of tests performed
      against a target. By specifying the type of test to include or exclude,
      faster, focused testing can be completed. This is useful in situations
      where the presence of certain file types are undesired -- such as XSS or
      simply "interesting" files.</p><p>Test types can be controlled at an individual level by specifying
      their identifier to the <em class="parameter"><code>-T</code></em>
      (<em class="parameter"><code>-Tuning</code></em>) option. In the default mode, if
      <em class="parameter"><code>-T</code></em> is invoked only the test type(s) specified
      will be executed. For example, only the tests for "Remote file
      retrieval" and "Command execution" can performed against the
      target:</p><pre class="screen">perl nikto.pl -h 192.168.0.1 -T 58</pre><p>If an "x" is passed to <em class="parameter"><code>-T</code></em> then this will
      negate all tests of types following the x. This is useful where a test
      may check several different types of exploit. For example:</p><pre class="screen">perl nikto.pl -h 192.168.0.1 -T 58xb</pre><p>The valid tuning options are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>0 - File Upload. Exploits which allow a file to be uploaded to
          the target server.</p></li><li class="listitem"><p>1 - Interesting File / Seen in logs. An unknown but suspicious
          file or attack that has been seen in web server logs (note: if you
          have information regarding any of these attacks, please contact
          CIRT, Inc.).</p></li><li class="listitem"><p>2 - Misconfiguration / Default File. Default files or files
          which have been misconfigured in some manner. This could be
          documentation, or a resource which should be password
          protected.</p></li><li class="listitem"><p>3 - Information Disclosure. A resource which reveals
          information about the target. This could be a file system path or
          account name.</p></li><li class="listitem"><p>4 - Injection (XSS/Script/HTML). Any manner of injection,
          including cross site scripting (XSS) or content (HTML). This does
          not include command injection.</p></li><li class="listitem"><p>5 - Remote File Retrieval - Inside Web Root. Resource allows
          remote users to retrieve unauthorized files from within the web
          server's root directory.</p></li><li class="listitem"><p>6 - Denial of Service. Resource allows a denial of service
          against the target application, web server or host (note: no
          intentional DoS attacks are attempted).</p></li><li class="listitem"><p>7 - Remote File Retrieval - Server Wide. Resource allows
          remote users to retrieve unauthorized files from anywhere on the
          target.</p></li><li class="listitem"><p>8 - Command Execution / Remote Shell. Resource allows the user
          to execute a system command or spawn a remote shell.</p></li><li class="listitem"><p>9 - SQL Injection. Any type of attack which allows SQL to be
          executed against a database.</p></li><li class="listitem"><p>a - Authentication Bypass. Allows client to access a resource
          it should not be allowed to access.</p></li><li class="listitem"><p>b - Software Identification. Installed software or program
          could be positively identified.</p></li><li class="listitem"><p>c - Remote source inclusion. Software allows remote inclusion
          of source code.</p></li><li class="listitem"><p>x - Reverse Tuning Options. Perform exclusion of the specified
          tuning type instead of inclusion of the specified tuning
          type.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249741152"></a>Replay Saved Requests</h2></div></div></div><p>When using the Save functionality (-Save), findings requests are
      saved in text files. While these files contain human readable text, they
      also contain JSON representations of the request and response. This JSON
      request can be replayed by using the "replay.pl" script.</p><p>The replay.pl reads and parses a saved file via the -file option,
      and can optionally run the request through a proxy, such as Burp. This
      will allow further exploration of vulnerabilities in a program better
      suited to replay and resend attacks.</p><pre class="screen">

$ ./replay -file savedir_host_80_2012-09-11-00-07-42/host_80_2012-09-11_002114.txt -proxy localhost:8080
--------------------------------------------  Info
Request to:     http://host:80/manual/
Test ID:        002114
OSVDB ID:       3092
Message:        OSVDB-3092: /manual/: Web server manual found.
--------------------------------------------  Response
date: Tue, 11 Sep 2012 04:14:20 GMT
server: Apache/2.2.21 (Unix) mod_ssl/2.2.21 OpenSSL/0.9.8r DAV/2 PHP/5.3.10 with Suhosin-Patch
content-location: index.html.en
vary: negotiate,accept-language,accept-charset
tcn: choice
last-modified: Tue, 06 Sep 2011 02:41:54 GMT
etag: "15eb9df-1f07-4ac3cc53d8080;15eb9dd-32b-4ac3cc53d8080"
accept-ranges: bytes
content-length: 7943
keep-alive: timeout=5, max=100
connection: Keep-Alive
content-type: text/html
content-language: en

&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"&gt;&lt;head&gt;&lt;!--
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
              This file is generated from xml source: DO NOT EDIT
        XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
      --&gt;
&lt;title&gt;Apache HTTP Server Version 2.2
Documentation - Apache HTTP Server&lt;/title&gt;
...

</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249738448"></a>Plugin selection</h2></div></div></div><p>From Nikto 2.1.2 plugins can be selected on an individual basis
      and may have parameters passed to them.</p><p>A plugin selection string may be passed on the command line
      through the <em class="parameter"><code>-Plugin</code></em> parameter. It consists of a
      semi-colon separated list of plugin names with option parameters placed
      in brackets. In simple form a plugin statement is like:</p><div class="blockquote"><blockquote class="blockquote"><p><em class="parameter"><code>plugin-name</code></em>[<span class="optional">(<em class="parameter"><code>parameter
        name</code></em>[<span class="optional">:<em class="parameter"><code>parameter value</code></em>
        </span>][<span class="optional">,<em class="parameter"><code>other
        parameters</code></em></span>] )</span>]</p></blockquote></div><p>For example we can do:</p><pre class="screen">tests(report:500,verbose)</pre><p>Which will set the parameters report to a value of 500 and verbose
      to a value of 1. The parameters and plugin names can be found be
      running:</p><pre class="screen">./nikto.pl -list-plugins</pre><p>This also means that we deprecate the mutate options and replace
      them with parameters passed to plugins, so the mutate options now
      internally translate to:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>tests(all)</p></li><li class="listitem"><p>tests(passfiles)</p></li><li class="listitem"><p>apacheusers(enumerate,home[,dictionary:dict.txt])</p></li><li class="listitem"><p>apacheusers(enumerate,cgiwrap[,dictionary:dict.txt])</p></li><li class="listitem"><p>subdomain</p></li><li class="listitem"><p>dictionary(dictionary:dict.txt)</p></li></ol></div><p>Macros for commonly run plugin sets can also be defined in
      nikto.conf, the default ones are:</p><pre class="screen">@@MUTATE=dictionary;subdomain
@@DEFAULT=@@ALL;-@@MUTATE;tests(report:500)</pre><p>These are expanded by using -list-plugins and can be overridden
      through -Plugins.</p><p>Altogether this can allow a customised set of plugins that may
      need to be run for a specific circumstance. For example if a normal test
      bought up that the server was vulnerable to the apache Expect header XSS
      attack and we want to run a test just to see that it is vulnerable by
      adding debugging, we can run:</p><pre class="screen">nikto.pl -host target.txt -Plugins "apache_expect_xss(verbose,debug)"</pre><p>And then manually check the output to see whether it was truly
      vulnerable.</p><p>It should be noted that reports are also plugins, so if you need
      to customize the plugin string and want an output, include the report
      plugin:</p><pre class="screen">nikto.pl -host targets.txt -Plugins "apacheusers(enumerate,dictionary:users.txt);report_xml" -output apacheusers.xml</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="configuration"></a>Chapter 5. Configuration Files</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446249718256">Location</a></span></dt><dt><span class="section"><a href="#idm446249712960">Format</a></span></dt><dt><span class="section"><a href="#idm446249711600">Variables</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249718256"></a>Location</h2></div></div></div><p>Nikto, like any non-trivial program needs to know a few things
      about how to work with the current environment. For most situations the
      default configuration file will work. Sometimes, tuning may be required,
      or some things may need to be changes.</p><p>Nikto will look for a configuration file in three places and if it
      finds one, will apply it in the strict order, listed below. A later
      found configuration file will overwrite any variables set in an earlier
      configuration file. The locations are:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>/etc/nikto.conf (this may be altered depending on
          platform)</p></li><li class="listitem"><p>$HOME/nikto.conf</p></li><li class="listitem"><p>nikto.conf</p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249712960"></a>Format</h2></div></div></div><p>The configuration files are formated like a standard Unix
      configuration file: blank lines are ignored, any line starting with a #
      is ignored, variables are set with VariableName=Value line.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249711600"></a>Variables</h2></div></div></div><p>The following variables may be set within the configuration
      file:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">CLIOPTS</code></span></dt><dd><p>Default options that should always be passed to the command
            line. For example:</p><pre class="screen">CLIOPTS=-output results.txt -Format text</pre><p>Default Setting</p><pre class="screen">CLIOPTS=</pre></dd><dt><span class="term"><code class="varname">NIKTODTD</code></span></dt><dd><p>Path to the location of the DTD used for XML output. If the
            path is not absolute then it will be relative to the directory
            where Nikto is executed.</p><p>Default Setting</p><pre class="screen">NIKTODTD=docs/nikto.dtd</pre></dd><dt><span class="term"><code class="varname">RFIURL</code></span></dt><dd><p>Full URL to an file for remote file inclusion. This file
            should contain a call to phpinfo(), as Nikto will look for the
            output of that command to determine that the RFI succeeded. You
            may use the default cirt.net file, but please keep in mind there
            must be connectivity from the target server to cirt.net, it's
            subject to cirt.net's availability, and successful requests will
            be logged (by Apache). We recommend you use your own.</p><p>Default Setting</p><pre class="screen">RFIURL=http://cirt.net/rfiinc.txt?</pre></dd><dt><span class="term"><code class="varname">SKIPPORTS</code></span></dt><dd><p>This configuration item defines ports that would never be
            scanned by Nikto.</p><p>Default Setting</p><pre class="screen">SKIPPORTS=21 111</pre></dd><dt><span class="term"><code class="varname">SKIPIDS</code></span></dt><dd><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Note, this filter only applies to tests in the
              <code class="filename">db_tests</code> database</p></div><p>Contains a space separated list of Test IDs (tids) that
            Nikto will not run on the system, for example:</p><pre class="screen">SKIPIDS=000045 000345</pre><p>Default Setting</p><pre class="screen">SKIPIDS=</pre></dd><dt><span class="term"><code class="varname">DEFAULTHTTPVER</code></span></dt><dd><p>Defines the default version of HTTP that Nikto will use,
            unless superceded by a specific test. Usually keeping this to the
            default will suffice, though some web servers may only work with
            later versions of the HTTP protocol.</p><p>Default Setting</p><pre class="screen">DEFAULTHTTPVER=1.0</pre></dd><dt><span class="term"><code class="varname">UPDATES</code></span></dt><dd><p>If the outdated Nikto plugin sees a web server it doesn't
            know of, or a version that is later than that defined in
            <code class="filename">db_outdated</code>, then it will send this
            information back to cirt.net for inclusion in future versions of
            Nikto. Server specific information (e.g. IP addresses or
            hostnames) are not sent.</p><p>This item can be set to one of the below values:</p><div class="blockquote"><blockquote class="blockquote"><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">UPDATES=yes</code></span></dt><dd><p>Display each submission and ask for permission
                    before it is sent</p></dd><dt><span class="term"><code class="varname">UPDATES=no</code></span></dt><dd><p>Do not send any data back to cirt.net</p></dd><dt><span class="term"><code class="varname">UPDATES=auto</code></span></dt><dd><p>Send data back to cirt.net with no prompting</p></dd></dl></div></blockquote></div><p>Default Setting</p><pre class="screen">UPDATES=yes</pre></dd><dt><span class="term"><code class="varname">LW_SSL_ENGINE</code></span></dt><dd><p>Force LibWhisker to use the specified SSL library instead of
            the default select (Net::SSLeay, if available).</p><p>This item can be set to one of the below values:</p><div class="blockquote"><blockquote class="blockquote"><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">LW_SSL_ENGINE=auto</code></span></dt><dd><p>use auto-selection</p></dd><dt><span class="term"><code class="varname">LW_SSL_ENGINE=SSL</code></span></dt><dd><p>use Net::SSL</p></dd><dt><span class="term"><code class="varname">LW_SSL_ENGINE=SSLeay</code></span></dt><dd><p>use Net::SSLeay</p></dd></dl></div></blockquote></div><p>Default Setting</p><pre class="screen">LW_SSL_ENGINE=auto</pre></dd><dt><span class="term"><code class="varname">MAX_WARN</code></span></dt><dd><p><span class="emphasis"><em>Unused</em></span></p><p>Produces a warning of a number of MOVED responses are
            retrieved. This is currently unused.</p><p>Default Setting</p><pre class="screen">MAX_WARN=20</pre></dd><dt><span class="term"><code class="varname">PROMPTS</code></span></dt><dd><p>Disables Nikto prompts if set to "no". This is currently
            only used to prompt for proxy authentication and sending
            updates.</p><p>Default Setting</p><pre class="screen">PROMPTS=</pre></dd><dt><span class="term"><code class="varname">CIRT</code></span></dt><dd><p>The IP address that Nikto will use to update the databases
            and plugins, or will send version information back to (as
            described in the <code class="varname">UPDATES</code> item).</p><p>Default Setting</p><pre class="screen">CIRT=174.142.17.165</pre></dd><dt><span class="term"><code class="varname">PROXYHOST</code>, </span><span class="term"><code class="varname">PROXYPORT</code>, </span><span class="term"><code class="varname">PROXYUSER</code>, </span><span class="term"><code class="varname">PROXYPASS</code></span></dt><dd><p>Address, port and username password of a proxy to relay all
            requests through. Note, to use a proxy, you must set the
            configuration items in the configuration file and supply the
            <em class="parameter"><code>-useproxy</code></em> switch to the command
            line.</p><p>Default Setting</p><pre class="screen">PROXYHOST=
PROXYPORT=
PROXYUSER=
PROXYPASS=</pre></dd><dt><span class="term"><code class="varname">STATIC-COOKIE</code></span></dt><dd><p>Adds the supplied cookie(s) to all requests made via Nikto.
            This is generally useful is an authentication cookie is required
            for a website. Separate cookies with a semi-colon, for
            example:</p><pre class="screen">STATIC-COOKIE="cookie1"="cookie value";"cookie2"="cookie val"</pre><p>Default Setting</p><pre class="screen">STATIC-COOKIE=</pre></dd><dt><span class="term"><code class="varname">CHECKMETHODS</code></span></dt><dd><p>Nikto will attempt to identify targets as webservers by
            sending a request to fetch the / URI via certain HTTP methods.
            Some web servers do not implement all HTTP methods and may cause
            Nikto to fail to identify the web server correctly if it doesn't
            support the method being used.</p><p>If this setting is missing from the configuration file, then
            Nikto will default back to the Nikto 2.02 default of HEAD.</p><p>Default Setting</p><pre class="screen">CHECKMETHODS=HEAD GET</pre></dd><dt><span class="term"><code class="varname">EXECDIR</code>, </span><span class="term"><code class="varname">PLUGINDIR</code>, </span><span class="term"><code class="varname">TEMPLATEDIR</code>, </span><span class="term"><code class="varname">DBDIR</code>, </span><span class="term"><code class="varname">DOCDIR</code></span></dt><dd><p>Defines where to find the location of Nikto, its plugins,
            databases, XML/HTML templates and documents. This should only
            normally be changed if repackaging Nikto to work with different
            file system standards. Nikto will use the EXECDIR item to guess
            the other directories.</p><p>Default Setting</p><pre class="screen">EXECDIR=.
PLUGINDIR=EXECDIR/plugins
TEMPLATEDIR=EXECDIR/templates
DBDIR=EXECDIR/databases
DOCDIR=EXECDIR/docs</pre></dd></dl></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="reports"></a>Chapter 6. Output and Reports</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446249643264">Export Formats</a></span></dt><dt><span class="section"><a href="#idm446249639120">HTML and XML Customisation</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249643264"></a>Export Formats</h2></div></div></div><p>Nikto allows output to be saved in a variety of formats, including
      text, CSV, HTML, XML, and NBE. When using
      <em class="parameter"><code>-output</code></em>, an output format may be specified with
      <em class="parameter"><code>-Format</code></em>.</p><p>If no <em class="parameter"><code>-Format</code></em> is specified, Nikto will try
      to guess the format from the file extension. If Nikto cannot guess the
      file format then output will only be sent to stdout.</p><p>The DTD for the Nikto XML format can be found in the 'docs'
      directory (nikto.dtd).</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249639120"></a>HTML and XML Customisation</h2></div></div></div><p>HTML reports are generated from template files located in the
      <code class="filename">templates</code> directory. Variables are defined as
      <code class="varname">#variable-name</code>, and are replaced when the report is
      generated. The files <code class="filename">htm_start.tmpl</code> and
      <code class="filename">htm_end.tmpl</code> are included at the beginning and end
      of the report (respectively). The <code class="filename">htm_summary.tmpl</code>
      also appears at the beginning of the report. The
      <code class="filename">htm_host_head</code> appears once for every host, and the
      <code class="filename">htm_host_item.tmpl</code> and
      <code class="filename">htm_host_im.tmpl</code> appear once for each item found on
      a host and each "informational message" per host (respectively).</p><p>All valid variables are used in these templates. Future versions
      of this documentation will include a list of variables and their
      meaning.</p><p>The copyright statements must not be removed from the
      <code class="filename">htm_end.tmpl</code> without placing them in another of the
      templates. It is a violation of the Nikto licence to remove these
      notices.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="developing"></a>Chapter 7. OSS Development</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446249630192">Open Source Contributions</a></span></dt><dt><span class="section"><a href="#idm446249628896">Development Source</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249630192"></a>Open Source Contributions</h2></div></div></div><p>Nikto is an open source project licensed under the GNU GPL
      license. As such, code updates are welcomed and very much
      appreciated.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249628896"></a>Development Source</h2></div></div></div><p>The Nikto development source code is located in a Subversion (SVN)
      repository which is publicly accessible. To download the source code,
      install Subversion and issue the following command:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>svn co http://svn2.assembla.com/svn/Nikto_2</p></li></ul></div><p>For more information on the development enviornment, please see:
      http://www.assembla.com/spaces/Nikto_2/trac_subversion_tool</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="expanding"></a>Chapter 8. Test and Code Writing</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446249624864">Scan Database Syntax</a></span></dt><dt><span class="section"><a href="#idm446249621936">Scan Database Field Values</a></span></dt><dt><span class="section"><a href="#idm446249601648">User-Defined Tests</a></span></dt><dt><span class="section"><a href="#idm446249595168">Plugins</a></span></dt><dt><span class="section"><a href="#idm446249574512">Initialization Phase</a></span></dt><dt><span class="section"><a href="#idm446249533568">Start hook</a></span></dt><dd><dl><dt><span class="section"><a href="#idm446249528768">Reconnaisance Phase</a></span></dt><dt><span class="section"><a href="#idm446249522160">Scan Phase</a></span></dt><dt><span class="section"><a href="#idm446249516880">Prefetch hook</a></span></dt><dt><span class="section"><a href="#idm446249509824">Postfetch hook</a></span></dt><dt><span class="section"><a href="#idm446249502448">Reporting Phase</a></span></dt><dt><span class="section"><a href="#idm446249464560">Data Structures</a></span></dt><dt><span class="section"><a href="#idm446249429200">Standard Methods</a></span></dt><dt><span class="section"><a href="#idm446249353712">Global Variables</a></span></dt></dl></dd><dt><span class="section"><a href="#idm446238811296">Test Identifiers</a></span></dt><dt><span class="section"><a href="#idm446238795136">Code Copyrights</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249624864"></a>Scan Database Syntax</h2></div></div></div><p>The scan database is a CSV delimited file which contains most of
      the tests. Fields are enclosed by quotes and separated by commas. The
      field order is:</p><p>Test-ID, OSVDB-ID, Tuning Type, URI, HTTP Method, Match 1, Match 1
      Or, Match1 And, Fail 1, Fail 2, Summary, HTTP Data, Headers</p><p>Here is an example test:</p><pre class="screen">"120","3092","2","/manual/","GET","200","","","","","Web server manual","",""</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249621936"></a>Scan Database Field Values</h2></div></div></div><p>Though some checks can be found in other plugins, the
      <code class="filename">db_tests</code> contains the bulk of the web test
      information. Here is a description of the field values:</p><div class="table"><a name="idm446249620128"></a><p class="title"><b>Table 8.1. Scan Database Fields</b></p><div class="table-contents"><table class="table" summary="Scan Database Fields" border="1"><colgroup><col><col></colgroup><tbody><tr><td>Test ID</td><td>Nikto test ID</td></tr><tr><td>OSVDB-ID</td><td>Corresponding vulnerability entry number for
              osvdb.org</td></tr><tr><td>Server Type</td><td>Check tuning types</td></tr><tr><td>URI</td><td>URI to retrieve</td></tr><tr><td>HTTP Method</td><td>HTTP method to use for URI</td></tr><tr><td>Match 1</td><td>String or code to match for successful test</td></tr><tr><td>Match 1 (Or)</td><td>String or code to alternatively match for successful
              test</td></tr><tr><td>Match 1 (And)</td><td>String or code to also match for successful test</td></tr><tr><td>Fail 1</td><td>String or code to match for test failure</td></tr><tr><td>Fail 2</td><td>String or code to match for test failure
              (alternative)</td></tr><tr><td>Summary</td><td>Summary message to report for successful test</td></tr><tr><td>HTTP Data</td><td>HTTP data to be sent during POST tests</td></tr><tr><td>Headers</td><td>Additional headers to send during test</td></tr></tbody></table></div></div><br class="table-break"><p>Variables from the db_variables or udb_variables files can be
      replaced in the URI field. These can be used to expand single checks
      into multiple locations, such as typical software install
      directories.</p><p>The Match 1, Match 1 (Or), Match 1 (And), Fail 1 and Fail 2 fields
      can have three types of values: numeric HTTP code, string/regex to match
      content, or MD5 hash. To use an MD5 hash of the returned content,
      preface the value with '@MD5', for example
      '@MD56a6fa5d848ccec771678bf04f2eaf627'.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249601648"></a>User-Defined Tests</h2></div></div></div><p>Users can create their own, private tests for any of the
      databases. By placing a syntactically correct database file in the
      <code class="filename">databases</code> directory, with a file name prefaced with
      a "u", the data will be loaded along with the built-in checks.</p><p>For example, create the file
      <code class="filename">databases/udb_tests</code> and it will be loaded at the
      same time <code class="filename">databases/db_tests</code> is loaded. These files
      will also be checked for syntax when <em class="parameter"><code>-dbcheck</code></em> is
      used.</p><p>For tests which require a "private" OSVDB ID, use the OSVDB ID 0
      (zero). This should be used for all vulnerabilities that do not (or
      should not) exist in OSVDB, as ID 0 is for testing only. You are
      encouraged to send missing information to OSVDB at
      moderators@osvdb.org.</p><p>For the "Test ID", it is recommended you use unique numbers
      between 400000 and 499999 to allow for growth of the Nikto database
      without interfering with your own tests (note: numbers above 500000 are
      reserved for other tests).</p><p>Please help Nikto's continued success by sending test updates to
      <code class="email">&lt;<a class="email" href="mailto:sullo@cirt.net">sullo@cirt.net</a>&gt;</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249595168"></a>Plugins</h2></div></div></div><p>Plugins allow other bits of code to hook into Nikto's processing
      and perform extra checks that cannot be achieved through the standard
      plugins.</p><p>Plugins can use several hooks, these are:</p><div class="blockquote"><blockquote class="blockquote"><div class="variablelist"><dl class="variablelist"><dt><span class="term">Initialization (mandatory)</span></dt><dd><p>Plugin initialization is performed before targets are
              assigned. During this phase, the plugin should tell Nikto about
              its existence and capabilities. It may optionally set up any
              later required variables.</p><p>This is always called for every plugin, even if the plugin
              will not be used in the scan. Any database loading or variable
              setup should be deferred to the start hook.</p></dd><dt><span class="term">Start (optional)</span></dt><dd><p>The start hook is called after target enumeration, but
              before target scanning occcurs, and will only be called on
              plugins that are scheduled to be run. It will only execute
              once.</p><p>This hook is normally used to load databases or to
              initialize memory for the plugin.</p></dd><dt><span class="term">Reconnaisance (optional)</span></dt><dd><p>During the reconnaisance phase, the plugin should look for
              interesting information that may be of use during the scan
              phase. It may report vulnerablities, though this is
              discouraged.</p></dd><dt><span class="term">Scan (optional)</span></dt><dd><p>The scan phase should perform the meat of the plugin -
              this is where it should look at the web server and return any
              potential vulnerabilities.</p></dd><dt><span class="term">Reporting (optional)</span></dt><dd><p>The reporting phase is used to export any found
              vulnerabilities into a format that they can be used later, for
              example written as a file report, or imported into a database.
              No testing of the web server, or reporting of new vulnerbilies
              should be performed in this phase.</p><p>This phase is slightly more complex than the others and
              may be called at several points during Nikto's execution, as
              detailed later</p></dd><dt><span class="term">Prefetch (optional)</span></dt><dd><p>The prefetch phase is called before every request to the
              server. It is passed a copy of the request hash and can amend it
              before it is sent to the server.</p><p>This is normally used where standard data is needed for
              every request, for example, if authentication is needed.</p><p>As this hook will be executed for every request made, for
              efficiency, the hook sub should be kept optimal. It is strongly
              advised that conditional execution (see below) is used to ensure
              that it is only run when needed.</p></dd><dt><span class="term">Postfetch (optional)</span></dt><dd><p>The postfetch phase is called after every request to the
              server. It is passed a copy of the response hash, so that it can
              check for content or header specific risks.</p><p>As this hook will be executed for every request made, for
              efficiency, the hook sub should be kept optimal. It is strongly
              advised that conditional execution (see below) is used to ensure
              that it is only run when needed.</p></dd></dl></div></blockquote></div><p>Plugins are written in standard perl in the current context. They
      should be placed within the <code class="varname">PLUGINDIR</code> defined in the
      Nikto configuration file and must have a filename ending in
      <code class="filename">.plugin</code>.</p><p>An important concept to grasp about plugins and the order that are
      executed in is plugin weight: each phase will execute all defined
      plugins in the order defined by the weight. A plugin's weight is defined
      as a number between 1 and 100, where 1 is high priority and 100 is low
      priority. Plugins of equal weight will be executed in an undefined
      order.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249574512"></a>Initialization Phase</h2></div></div></div><p>As described above, all plugins must be able to execute in the
      initialisation phase or they will be ignored.</p><p>A perl sub must exist called
      <code class="function"><em class="replaceable"><code>filename</code></em>_init</code>. The sub
      is passed no parameters and should return a hash reference to a hash
      that should contain the following entries:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="structfield"><code>name</code></em> (mandatory)</span></dt><dd><p>The short name of the plugin. This is used to identify the
            plugin during verbose logging and will, in future versions, be
            used to select plugin execution. The name should be one word and,
            ideally, lower case.</p></dd><dt><span class="term"><em class="structfield"><code>full_name</code></em> (mandatory)</span></dt><dd><p>The full name of the plugin. This is used to identify the
            plugin during verbose logging and may be used in reporting modules
            to identify tests run against the web server.</p></dd><dt><span class="term"><em class="structfield"><code>author</code></em> (mandatory)</span></dt><dd><p>The name or handle of the author of the plugin. This may be
            used during reporting to identify ownerships of copyright of tests
            run against the web server.</p></dd><dt><span class="term"><em class="structfield"><code>description</code></em> (mandatory)</span></dt><dd><p>A short sentence to describe the purpose of the plugin. This
            may be used during reporting, or by a front end to describe the
            purpose of the plugin.</p></dd><dt><span class="term"><em class="structfield"><code>copyright</code></em> (mandatory)</span></dt><dd><p>The copyright string (or lack of it) of the plugin. This may
            be used during reporting to ensure that appropriate copyright is
            assigned to reports.</p></dd><dt><span class="term"><em class="structfield"><code>hooks</code></em> (optional)</span></dt><dd><p>This should be a hash of hashes that contains information
            about the hooks that the plugin can respond to.</p><p>Each key of the hooks element should be the name of the
            required hook with a hash value that details the information. The
            components of the hash should be:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="structfield"><code>method</code></em> (mandatory)</span></dt><dd><p>This should be a reference to a function called for
                  the hook.</p></dd><dt><span class="term"><em class="structfield"><code>cond</code></em> (optional)</span></dt><dd><p>This is an expression to be evaluated before the
                  plugin is executed; if true, the plugins is executed, if
                  false, the plugin is skipped. This can be used to minimise
                  plugin execution.</p></dd><dt><span class="term"><em class="structfield"><code>weight</code></em> (optional)</span></dt><dd><p>This is the weight used to schedule the running of the
                  plugin during the reconnaisance phase. If this is left
                  undefined it will default to 50.</p></dd></dl></div></dd><dt><span class="term"><em class="structfield"><code>options</code></em> (optional)</span></dt><dd><p>This is a hash that contains help information about any
            parameters that can be passed to the plugin. The information will
            be shown if the <em class="parameter"><code>-list-plugins</code></em> parameter is
            used.</p><p>Each key of the options element should be the name of the
            parameter, with a value of a string providing a brief description
            of the parameter.</p></dd><dt><span class="term"><em class="structfield"><code>report_head</code></em> (optional)</span></dt><dd><p>This should be a reference to a function executed before any
            testing commences. If this is left undefined then the plugin will
            not be called to produce a report header.</p></dd><dt><span class="term"><em class="structfield"><code>report_host_start</code></em> (optional)</span></dt><dd><p>This should be a reference to a function executed before the
            reconnaisance phase of each host. If this is left undefined then
            the plugin will not be called to produce a host header.</p></dd><dt><span class="term"><em class="structfield"><code>report_host_end</code></em> (optional)</span></dt><dd><p>This should be a reference to a function executed after the
            scan phase of each host. If this is left undefined then the plugin
            will not be called to produce a host footer.</p></dd><dt><span class="term"><em class="structfield"><code>report_item</code></em> (optional)</span></dt><dd><p>This should be a reference to a function executed after each
            found vulnerability. If this is left undefined then the plugin
            will not be called to produce an item record.</p></dd><dt><span class="term"><em class="structfield"><code>report_close</code></em> (optional)</span></dt><dd><p>This should be a reference to a function executed after
            testing of all hosts has been finished. If this is left undefined
            then the plugin will not be called to close the report.</p></dd><dt><span class="term"><em class="structfield"><code>report_format</code></em> (optional)</span></dt><dd><p>This should describe the file format that the plugin
            handles. This is internally matched with the contents of the
            <em class="parameter"><code>-output</code></em> switch to reduce excessive calls to
            plugins.</p></dd><dt><span class="term"><em class="structfield"><code>report_weight</code></em> (optional)</span></dt><dd><p>This is the weight used to schedule the running of the
            plugin during the reporting phase. If this is left undefined it
            will default to 50.</p></dd></dl></div><div class="example"><a name="idm446249535136"></a><p class="title"><b>Example 8.1. Example initialisation function</b></p><div class="example-contents"><pre class="programlisting">sub nikto_auth_init {
    my $id = { name             =&gt; 'auth',
               full_name        =&gt; 'Guess authentication',
               author           =&gt; 'Sullo/Deity',
               description      =&gt; 'Attempt to guess authentication realms',
               hooks            =&gt; {
                                    start =&gt; {
                                       method =&gt; \&amp;nikto_auth_load,
                                       weight =&gt; 1,
                                    },
                                    postfetch =&gt; {
                                       method =&gt; \&amp;nikto_auth,
                                       weight =&gt; 19,
                                       cond   =&gt; '$result-&gt;{whisker}-&gt;{code} eq 401',
                                    },
                                    prefetch =&gt; {
                                       method =&gt; \&amp;nikto_auth_pre,
                                       weight =&gt; 19,
                                    },
                                   },                   
               copyright        =&gt; "2010 CIRT Inc"
               };

    return $id;
}</pre></div></div><br class="example-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446249533568"></a>Start hook</h2></div></div></div><p>The Start hook is called between target and enumeration and the
      start of scanning. It will only ever be called once, no matter how many
      targets Nikto is being run against. It will only be run against plugins
      that will be executed later.</p><p>This makes it the ideal place to set up any required variables,
      assign variables or load databases for the plugin to be used in response
      to later hooks.</p><p>The start method is passed no parameters and should return
      nothing.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
          <b class="fsfunc">start_method</b>(</code></td><td><var class="pdparam">void</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code><var class="pdparam">void</var></code>;</div><div class="funcprototype-spacer"> </div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249528768"></a>Reconnaisance Phase</h3></div></div></div><p>The reconnaisance phase is executed for each target at the start
        of each scan.</p><p>Each reconnaisance method such expect to take a
        <code class="varname">mark</code> hash ref. It should return nothing.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
            <b class="fsfunc">recon_method</b>(</code></td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">parameters</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;<br><code>hashref <var class="pdparam">parameters</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>The reconnaisance phase is intended to be used to pull
        information about the web server for later use by the plugin, or by
        other plugins. Reporting vulnerabilities in this phase is
        discouraged.</p><p>Example uses of the reconnaisance phase are to spider a site,
        check for known applications etc.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249522160"></a>Scan Phase</h3></div></div></div><p>The scan phase is the meat of the plugin's life, this is run,
        for each target, immediately after the reconnaisance phase.</p><p>Each scan should check for vulnerabilities it knows about and
        report on them as it finds one.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
            <b class="fsfunc">scan_method</b>(</code></td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">parameters</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;<br><code>hashref <var class="pdparam">parameters</var></code>;</div><div class="funcprototype-spacer"> </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249516880"></a>Prefetch hook</h3></div></div></div><p>The prefetch hook is executed before any request is made to the
        target. It is designed to allow the plugin to alter the libwhisker
        hash before the request.</p><p>In normal execution, the prefetch hook should not report
        vulnerabilities.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">hashref request, hashref response
            <b class="fsfunc">prefetch_method</b>(</code></td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">parameters</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">request</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">result</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;<br><code>hashref <var class="pdparam">parameters</var></code>;<br><code>hashref <var class="pdparam">request</var></code>;<br><code>hashref <var class="pdparam">result</var></code>;</div><div class="funcprototype-spacer"> </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249509824"></a>Postfetch hook</h3></div></div></div><p>The postfetch hook is the executed after any request is made to
        the target. It is designed to allow the plugin to check for issues
        with the response, such as vulnerable headers or content.</p><p>In normal execution, the postfetch hook should report any
        vulnerabilities that it finds.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">hashref request, hashref response
            <b class="fsfunc">postfetch_method</b>(</code></td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">parameters</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">request</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">result</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;<br><code>hashref <var class="pdparam">parameters</var></code>;<br><code>hashref <var class="pdparam">request</var></code>;<br><code>hashref <var class="pdparam">result</var></code>;</div><div class="funcprototype-spacer"> </div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249502448"></a>Reporting Phase</h3></div></div></div><p>This is potentially the most convoluted phase as it has several
        hooks that may be used for each section in the scan's lifetime.</p><p>The hooks are:</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249500864"></a>Report Head</h4></div></div></div><p>This hook is called immediately after target acquisition and
          before the reconnaisance phase. It is designed to allow the
          reporting plugin to open the report and ensure that any headers are
          appropiately written.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">handle
              <b class="fsfunc">report_head</b>(</code></td><td><var class="pdparam">filename</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">filename</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>The <em class="parameter"><code>filename</code></em> parameter is a bit of a
          misnomer; it will be a copy of the string passed to the
          <em class="parameter"><code>-output</code></em> switch and may indicate, for example,
          a database name.</p><p>The <em class="parameter"><code>handle</code></em> is a handle that will be
          passed to other reporting functions for this plugin so should be
          internally consistent.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249493648"></a>Report Host Start</h4></div></div></div><p>This hook is called immediately before the reconnaisance phase
          for each target. It is designed to allow the reporting plugin to
          write any host specfic information.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <b class="fsfunc">report_host_start</b>(</code></td><td><var class="pdparam">rhandle</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mark</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>handle <var class="pdparam">rhandle</var></code>;<br><code>hashref <var class="pdparam">mark</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>The <em class="parameter"><code>rhandle</code></em> parameter is the output of
          the plugin's Report Head function.</p><p>The <em class="parameter"><code>mark</code></em> parameter is a hashref for the
          target information (described below).</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249486368"></a>Report Host End</h4></div></div></div><p>This hook is called immediately after the scan phase for each
          target. It is designed to allow the reporting plugin to close any
          host specfic information.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <b class="fsfunc">report_host_end</b>(</code></td><td><var class="pdparam">rhandle</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mark</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>handle <var class="pdparam">rhandle</var></code>;<br><code>hashref <var class="pdparam">mark</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>The <em class="parameter"><code>rhandle</code></em> parameter is the output of
          the plugin's Report Head function.</p><p>The <em class="parameter"><code>mark</code></em> parameter is a hashref for the
          target information (described below).</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249479136"></a>Report Item</h4></div></div></div><p>This hook is called once for each vulnerability found on the
          target This should report details about the vulnerability.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <b class="fsfunc">report_item</b>(</code></td><td><var class="pdparam">rhandle</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">vulnerbility</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>handle <var class="pdparam">rhandle</var></code>;<br><code>hashref <var class="pdparam">mark</var></code>;<br><code>hashref <var class="pdparam">vulnerbility</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>The <em class="parameter"><code>rhandle</code></em> parameter is the output of
          the plugin's Report Head function.</p><p>The <em class="parameter"><code>mark</code></em> parameter is a hashref for the
          target information (described below).</p><p>The <em class="parameter"><code>vulnerability</code></em> parameter is a
          hashref for the vulnerability information (described below).</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249469888"></a>Report Close</h4></div></div></div><p>This hook is called immediately after all targets have been
          scanned. It is designed to allow the reporting plugin to elegantly
          close the report.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void
              <b class="fsfunc">report_close</b>(</code></td><td><var class="pdparam">rhandle</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>handle <var class="pdparam">rhandle</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>The <em class="parameter"><code>rhandle</code></em> parameter is the output of
          the plugin's Report Head function.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249464560"></a>Data Structures</h3></div></div></div><p>The below data structures are used to communicate between the
        various plugin methods. Unless otherwise mentioned, they are all
        standard perl hash references with the detailed members.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249463312"></a><span class="structname">Mark</span></h4></div></div></div><p>The mark hash contains all information about a target. It
          contains the below members. It should be read-only.</p><div class="blockquote"><blockquote class="blockquote"><div class="table"><a name="idm446249461760"></a><p class="title"><b>Table 8.2. Members of the <span class="structname">Mark</span>
              structure</b></p><div class="table-contents"><table class="table" summary="Members of the Mark
              structure" border="1"><colgroup><col><col></colgroup><tbody><tr><td><em class="structfield"><code>ident</code></em></td><td>Host identifier, usually equivalent to what was
                    passed on the command line.</td></tr><tr><td><em class="structfield"><code>hostname</code></em></td><td>Host name of the target.</td></tr><tr><td><em class="structfield"><code>ip</code></em></td><td>IP address of the target.</td></tr><tr><td><em class="structfield"><code>port</code></em></td><td>TCP port of the target.</td></tr><tr><td><em class="structfield"><code>display_name</code></em></td><td>Either the hostname, or the IP address of the
                    target, dependant on whether a hostname has been
                    discovered.</td></tr><tr><td><em class="structfield"><code>ssl</code></em></td><td>Flag to indicate whether the target runs over SSL.
                    If it is set to 0, then the plugin should not use SSL. Any
                    other value indicates SSL should be used.</td></tr><tr><td><em class="structfield"><code>vhost</code></em></td><td>Virtual hostname to use for the target.</td></tr><tr><td><em class="structfield"><code>root</code></em></td><td>Root URI to use for the target.</td></tr><tr><td><em class="structfield"><code>banner</code></em></td><td>Banner of the target's web server.</td></tr></tbody></table></div></div><br class="table-break"></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249446928"></a>Parameters</h4></div></div></div><p>The parameters hash contains all parameters that are passed
          directly to a plugin through one of the hooks.</p><p>The hash has a key of the parameter name and a value of the
          passed parameter. Implementation and sanity checking of the values
          is left up to the plugin.</p><p>If a parameter has not been set, it will not be in the hash.
          If it has been set to an undefined value, it will be set to the
          number 1 in the hash.</p><p>Some parameters, such as <em class="parameter"><code>verbose</code></em> and
          <em class="parameter"><code>debug</code></em> will be automatically handled by the
          Nikto, though the parameters will still be included in the
          hash.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="idm446249442672"></a>Vulnerability</h4></div></div></div><p>The vulnerability hash contains all information about a
          vulnerability. It contains the below members. It should be read-only
          and should only be written using the
          <code class="function">add_vulnerability</code> method.</p><div class="blockquote"><blockquote class="blockquote"><div class="table"><a name="idm446249440496"></a><p class="title"><b>Table 8.3. Members of the <span class="structname">Vulnerability</span>
              structure</b></p><div class="table-contents"><table class="table" summary="Members of the Vulnerability
              structure" border="1"><colgroup><col><col></colgroup><tbody><tr><td>mark</td><td>Hash ref to a mark data structure.</td></tr><tr><td>message</td><td>Message for the vulnerability.</td></tr><tr><td>nikto_id</td><td>Test ID (tid) of the vulnerability, this should be
                    a unique number which'll identify the
                    vulnerability.</td></tr><tr><td>osvdb</td><td>OSVDB reference to the vulnerability in the Open
                    Source Vulnerability Database. This may be 0 if an OSVDB
                    reference is not relevant or doesn't exist.</td></tr><tr><td>method</td><td>HTTP method used to find the vulnerability.</td></tr><tr><td>uri</td><td>URI for the result.</td></tr><tr><td>result</td><td>Any HTTP data, excluding headers.</td></tr></tbody></table></div></div><br class="table-break"></blockquote></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249429200"></a>Standard Methods</h3></div></div></div><p>Several standard methods are defined in
        <code class="filename">nikto_core.plugin</code> that can be used for all
        plugins. It is strongly advised that these should be used where
        possible instead of writing new methods.</p><p>For some methods, such as <code class="function">add_vulnerability</code>
        which write to global variables, these <span class="emphasis"><em>must</em></span> be
        the only interface to those global variables.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">array <b class="fsfunc">change_variables</b>(</code></td><td><var class="pdparam">line</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">line</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Expands any variables in the line parameter. The expansions are
        variables defined in the global array <code class="varname">@VARIABLES</code>,
        which may be read from <code class="filename">db_variables</code>, or added by
        reconnaisance plugin methods.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">is_404</b>(</code></td><td><var class="pdparam">uri</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">content</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">HTTPcode</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">uri</var></code>;<br><code>string <var class="pdparam">content</var></code>;<br><code>string <var class="pdparam">HTTPcode</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Makes a guess whether the result is a real web page or an error
        page. As several web servers are badly configured and don't return
        HTTP 404 codes when a page isn't found, Nikto attempts to look for
        common error pages. Returns 1 if the page looks like an error.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">string <b class="fsfunc">get_ext</b>(</code></td><td><var class="pdparam">uri</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">uri</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Attempts to work out the extension of the uri. Will return the
        extension or the special cases: DIRECTORY, DOTFILE, NONE.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">string <b class="fsfunc">date_disp</b>(</code></td><td><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>void</code>;</div><div class="funcprototype-spacer"> </div></div><p>Returns the current time in a human readable format (YYYY-mm-dd
        hh:mm:ss)</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">string <b class="fsfunc">rm_active</b>(</code></td><td><var class="pdparam">content</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">content</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Attempts to remove active content (e.g. dates, adverts etc.)
        from a page. Returns a filtered version of the content.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">string <b class="fsfunc">get_banner</b>(</code></td><td><var class="pdparam">mark</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Pulls the web servers banner. This is automatically performed
        for all targets before a mark is passed to the plugin.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">boolean <b class="fsfunc">content_present</b>(</code></td><td><var class="pdparam">HTTPcode</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">HTTPcode</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Checks the HTTPresponse against known "found" responses. TRUE
        indicates that the request was probably successful.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">string HTTPCode, string content
            <b class="fsfunc">nfetch</b>(</code></td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uri</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">method</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">content</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">headers</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">flags</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">testid</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;<br><code>string <var class="pdparam">uri</var></code>;<br><code>string <var class="pdparam">method</var></code>;<br><code>string <var class="pdparam">content</var></code>;<br><code>hashref <var class="pdparam">headers</var></code>;<br><code>hashref <var class="pdparam">flags</var></code>;<br><code>string <var class="pdparam">testid</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Makes a simple request through libwhisker with the passed
        parameters. nfetch is hook aware and will cause all requests to be
        passed through the prefetch and postfetch hooks.</p><p>The <em class="parameter"><code>flags</code></em> hash is a selection of flags
        that may modify the behaviour of the request. The current flags are
        defined:</p><div class="blockquote"><blockquote class="blockquote"><div class="table"><a name="idm446249391280"></a><p class="title"><b>Table 8.4. Members of the <span class="structname">flags</span>
            structure</b></p><div class="table-contents"><table class="table" summary="Members of the flags
            structure" border="1"><colgroup><col><col></colgroup><tbody><tr><td><em class="structfield"><code>noclean</code></em></td><td>Tells nfetch not to perform sanity checks on the
                  structure. Normally requests will be checked to ensure that
                  a valid Host header is included and that the Content-Length
                  header matches the size of any content, setting this flag
                  prevents the checks</td></tr><tr><td><em class="structfield"><code>noprefetch</code></em></td><td>Tells nfetch not to run the prefetch hook.</td></tr><tr><td><em class="structfield"><code>nopostfetch</code></em></td><td>Tells nfetch not to run the postfetch hook.</td></tr><tr><td><em class="structfield"><code>noerror</code></em></td><td>Tells nfetch not to report error responses from the
                  request.</td></tr></tbody></table></div></div><br class="table-break"></blockquote></div><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">hashref <b class="fsfunc">setup_hash</b>(</code></td><td><var class="pdparam">requesthash</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">mark</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">requesthash</var></code>;<br><code>hashref <var class="pdparam">mark</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Sets up up a libwhisker hash with the normal Nikto variables.
        This should be used if any custom calls to libwhisker are used.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">string <b class="fsfunc">char_escape</b>(</code></td><td><var class="pdparam">line</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">line</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Escapes any characters within line.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">array <b class="fsfunc">parse_csv</b>(</code></td><td><var class="pdparam">text</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">text</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Breaks a line of CSV text into an array of items.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">arrayref <b class="fsfunc">init_db</b>(</code></td><td><var class="pdparam">dbname</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">dbname</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Initializes a database that is in <code class="varname">PLUGINDIR</code>
        and returns an arrayref. The arrayref is to an array of hashrefs, each
        hash member is configured by the first line in the database file, for
        example:</p><pre class="screen">"nikto_id","md5hash","description"</pre><p>This will result in an array of hashrefs with parameters:</p><pre class="screen">array[0]-&gt;{nikto_id}
array[0]-&gt;{md5hash}
array[0]-&gt;{description}</pre><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void <b class="fsfunc">add_vulnerability</b>(</code></td><td><var class="pdparam">mark</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">message</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">nikto_id</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">osvdb</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">method</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">uri</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">data</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>hashref <var class="pdparam">mark</var></code>;<br><code>string <var class="pdparam">message</var></code>;<br><code>string <var class="pdparam">nikto_id</var></code>;<br><code>string <var class="pdparam">osvdb</var></code>;<br><code>string <var class="pdparam">method</var></code>;<br><code>string <var class="pdparam">uri</var></code>;<br><code>string <var class="pdparam">data</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Adds a vulnerability for the mark, displays it to standard out
        and sends it to any reporting plugins.</p><div class="funcsynopsis"><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">void <b class="fsfunc">nprint</b>(</code></td><td><var class="pdparam">message</var>, </td><td> </td></tr><tr><td> </td><td><var class="pdparam">display</var><code>)</code>;</td><td> </td></tr></table><div class="paramdef-list"><code>string <var class="pdparam">message</var></code>;<br><code>string <var class="pdparam">display</var></code>;</div><div class="funcprototype-spacer"> </div></div><p>Prints <em class="parameter"><code>message</code></em> to standard out.
        <em class="parameter"><code>Display</code></em> specifies a filter for the message,
        currently this can be "v" for verbose and "d" for debug output.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="idm446249353712"></a>Global Variables</h3></div></div></div><p>The following global variables exist within Nikto, most of them
        are defined for internal use and their use by plugins is not advised.
        Several have been deprecated, these should not be used by
        plugins.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="varname">%TEMPLATES</code> (read/write)</span></dt><dd><p>Hash to store the HTML and XML report templates.</p></dd><dt><span class="term"><code class="varname">%CONTENTSEARCH</code> (read)</span></dt><dd><p>Hash to contain all the entries in db_content_search - a
              list of strings and related info to alert on from any request
              (regardless of test result).</p></dd><dt><span class="term"><code class="varname">%CLI</code> (read)</span></dt><dd><p>Hash of passed CLI parameters</p></dd><dt><span class="term"><code class="varname">%VARIABLES</code> (read) (write)</span></dt><dd><p>Hash of contents of the entries in db_variables. Plugins
              should only write to this hash in the reconnaisance
              phase.</p></dd><dt><span class="term"><code class="varname">%TESTS</code> (read) (write)</span></dt><dd><p>Hash of the db_tests database. This is only intended to be
              used by the tests plugin, though it could be used by a
              reconnaisance plugin to add tests on the fly.</p></dd><dt><span class="term"><code class="varname">%NIKTO</code> (read)</span></dt><dd><p>Hash which contains internal Nikto data, such as help for
              the command line parameters.</p></dd><dt><span class="term"><code class="varname">%CONFIGFILE</code> (read)</span></dt><dd><p>Hash containing the data read from the configuration
              files.</p></dd><dt><span class="term"><code class="varname">%request</code> (read) (write)
            (deprecated), </span><span class="term"><code class="varname">%result</code> (read) (write)
            (deprecated)</span></dt><dd><p>Global libwhisker hash. This should not be used; nfetch or
              a local hash should be used.</p></dd><dt><span class="term"><code class="varname">%COUNTERS</code> (read) (write)</span></dt><dd><p>Hash containing various global counters (e.g. number of
              requests)</p></dd><dt><span class="term"><code class="varname">%db_extensions</code> (read) (deprecated)</span></dt><dd><p>Hash containing a list of common extensions</p></dd><dt><span class="term"><code class="varname">%FoF</code> (read) (write)</span></dt><dd><p>Hash containing data for each extension and what the
              server produces if a request for a non-existent file is
              requested.</p></dd><dt><span class="term"><code class="varname">%UPDATES</code> (read) (write)</span></dt><dd><p>Hash containing any updates that need to be sent back to
              cirt.net</p></dd><dt><span class="term"><code class="varname">$DIV</code> (read)</span></dt><dd><p>Divider mark for the items sent to standard out.</p></dd><dt><span class="term"><code class="varname">@DBFILE</code> (read)</span></dt><dd><p>Placeholder used to hold the contents of
              <code class="filename">db_tests</code>.</p></dd><dt><span class="term"><code class="varname">$PROXYCHECKED</code> (read) (deprecated)</span></dt><dd><p>Flag to see whether connection through the proxy has been
              checked.</p></dd><dt><span class="term"><code class="varname">@RESULTS</code> (read)</span></dt><dd><p>Array of reported vulnerabilities, should only be written
              to through <code class="function">add_vulnerability.</code></p></dd><dt><span class="term"><code class="varname">@PLUGINS</code> (read)</span></dt><dd><p>Array of hashrefs for each plugin. Used internally to run
              plugins.</p></dd><dt><span class="term"><code class="varname">@MARKS</code> (read)</span></dt><dd><p>Array of marks to indicate each target.</p></dd><dt><span class="term"><code class="varname">@REPORTS</code> (read)</span></dt><dd><p>Ordered array that reporting plugins should be run in.
              Used for efficency on calling reporting plugins.</p></dd></dl></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238811296"></a>Test Identifiers</h2></div></div></div><p>Each test, whether it comes from one of the databases or in code,
      must have a unique identifier. The numbering scheme for writing tests is
      as follows:</p><div class="blockquote"><blockquote class="blockquote"><div class="table"><a name="idm446238809808"></a><p class="title"><b>Table 8.5. TID Scheme</b></p><div class="table-contents"><table class="table" summary="TID Scheme" border="1"><colgroup><col><col></colgroup><tbody><tr><td>000000</td><td>db_tests</td></tr><tr><td>400000</td><td>user defined tests (<code class="filename">udb*</code>
                files)</td></tr><tr><td>500000</td><td>db_favicon</td></tr><tr><td>600000</td><td>db_outdated</td></tr><tr><td>700000</td><td>db_realms</td></tr><tr><td>750000</td><td>db_content_search</td></tr><tr><td>800000</td><td>db_server_msgs</td></tr><tr><td>900000</td><td>tests defined in code</td></tr></tbody></table></div></div><br class="table-break"></blockquote></div><p>As much data as possible in the <code class="varname">%TESTS</code> hash
      should be populated for each new test that is defined in code (plugins).
      These fields include URI for the test, message to print on success, HTTP
      method and OSVDB ID. Without a 'message' value in
      <code class="varname">%TESTS</code> output will not be saved in HTML or XML
      reports. Not all tests are expected to have a uri, method or OSVDB ID.
      Here is an example of setting those fields:</p><pre class="screen">$TESTS{999999}{uri}="/~root";
$TESTS{999999}{message}="Enumeration of users is possible by requesting ~username";
$TESTS{999999}{method}="GET";
$TESTS{999999}{osvdb}=637;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238795136"></a>Code Copyrights</h2></div></div></div><p>Any new or updated code, tests or information sent to the author
      is assumed to free of copyrights. By sending new or updated code, tests
      or information to the author you relinquish all claims of copyright on
      the material, and agree that this code can be claimed under the same
      copyright as Nikto.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="troubleshooting"></a>Chapter 9. Troubleshooting</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446238792512">SOCKS Proxies</a></span></dt><dt><span class="section"><a href="#idm446238791296">Debugging</a></span></dt><dt><span class="section"><a href="#idm446238789232">Assistance</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238792512"></a>SOCKS Proxies</h2></div></div></div><p>Nikto does not currently support SOCKS proxies.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238791296"></a>Debugging</h2></div></div></div><p>The major route to debugging Nikto requests is to use the
      <em class="parameter"><code>-Display</code></em> with v (verbose) or d (debug). This will
      output a vast amount of extra information to the screen, so it is
      advised to redirect output to a file when using them.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238789232"></a>Assistance</h2></div></div></div><p>If you need assistance with development or running Nikto, the
      Nikto-discuss mailing list can be an excellent resource and is an easy
      way to contact the developers and other knowledgeable users. For more
      information on the maling list, including archives and subscription
      options, please see http://cirt.net/nikto-discuss.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="licences"></a>Chapter 10. Licenses</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446238786624">Nikto</a></span></dt><dt><span class="section"><a href="#idm446238785344">LibWhisker</a></span></dt><dt><span class="section"><a href="#idm446238784048">Tests</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238786624"></a>Nikto</h2></div></div></div><p>Nikto is licensed under the GNU General Public License (GPL), and
      copyrighted by CIRT, Inc.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238785344"></a>LibWhisker</h2></div></div></div><p>LibWhisker is licensed under the GNU General Public License (GPL),
      and Copyright (c) 2009, Jeff Forristal (wiretrip.net)</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238784048"></a>Tests</h2></div></div></div><p>The web tests are licensed for use with Nikto only, and may not be
      reused without written consent from CIRT, Inc.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="credits"></a>Chapter 11. Credits</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="#idm446238781632">Nikto</a></span></dt><dt><span class="section"><a href="#idm446238780304">Thanks</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238781632"></a>Nikto</h2></div></div></div><p>Nikto is written and maintained by Chris Sullo and David Lodge.
      LibWhisker is written and maintained by Jeff Forristal (Rain Forrest
      Puppy).</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm446238780304"></a>Thanks</h2></div></div></div><p>Many people have provided feedback, fixes, and suggestions. This
      list is a feeble attempt to thank a few people, in no particular
      order:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Nikto 2 Testing: Paul Woroshow, Mark G. Spencer, Michel Arboi,
          Jericho, rfp.</p></li><li class="listitem"><p>Jericho (attrition.org/OSVDB/OSF).
          Support/ideas/tests/corrections/spam and help matching OSVDB IDs to
          tests.</p></li><li class="listitem"><p>rfp (wiretrip.net). LibWhisker and continuing support.</p></li><li class="listitem"><p>Erik Cabetas for many updates and fixes.</p></li><li class="listitem"><p>Jake Kouns (OSVDB/OSF).</p></li><li class="listitem"><p>Jabra (spl0it.org) for XML DTD, XML templates and supporting
          code.</p></li><li class="listitem"><p>Stephen Valdez for extensive testing and being a great
          guy.</p></li><li class="listitem"><p>S Saady. Extensive testing.</p></li><li class="listitem"><p>P Eronen (nixu.com). Provided many code fixes.</p></li><li class="listitem"><p>M Arboi. Great support by writing the code to make Nikto work
          within Nessus, as well as bug reports.</p></li><li class="listitem"><p>J DePriest. Ideas/fixes.</p></li><li class="listitem"><p>P Woroshow. Ideas/fixes.</p></li><li class="listitem"><p>fr0stman. Tests.</p></li><li class="listitem"><p>H Heimann. Tests.</p></li><li class="listitem"><p>Xiola (xiola.net). Web design and more.</p></li><li class="listitem"><p>Ryan Dewhurst. Domain guessing code.</p></li><li class="listitem"><p>Frank Breedijk. NBE exporter code.</p></li><li class="listitem"><p>Sussurro. MSF exporter code.</p></li><li class="listitem"><p>Joe Hart, Gavin Jones, Ed Williams (Dyn_llandeilo). Lots of
          suggestions and bug finding.</p></li></ul></div><p>This document is © 2010 CIRT, Inc. and may not be reused without
      permission.</p></div></div></div></body></html>
